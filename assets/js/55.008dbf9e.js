(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{249:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vueçš„å“åº”å¼ç³»ç»Ÿ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vueçš„å“åº”å¼ç³»ç»Ÿ","aria-hidden":"true"}},[t._v("#")]),t._v(" Vueçš„å“åº”å¼ç³»ç»Ÿ")]),t._v(" "),a("p",[t._v("ç‚¹å‡»å…³æ³¨æœ¬"),a("a",{attrs:{href:"#%E5%85%AC%E4%BC%97%E5%8F%B7"}},[t._v("å…¬ä¼—å·")]),t._v("è·å–æ–‡æ¡£æœ€æ–°æ›´æ–°,å¹¶å¯ä»¥é¢†å–é…å¥—äºæœ¬æŒ‡å—çš„ "),a("strong",[t._v("ã€Šå‰ç«¯")]),t._v("æ‰‹å†Œã€‹** ä»¥åŠ"),a("strong",[t._v("æœ€æ ‡å‡†çš„ç®€å†æ¨¡æ¿")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"å“åº”å¼ç³»ç»Ÿ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“åº”å¼ç³»ç»Ÿ","aria-hidden":"true"}},[t._v("#")]),t._v(" å“åº”å¼ç³»ç»Ÿ")]),t._v(" "),a("p",[t._v("UI åœ¨ MVVM ä¸­æŒ‡çš„æ˜¯ Viewï¼ŒçŠ¶æ€åœ¨ MVVM ä¸­æŒ‡çš„æ˜¯ Modalï¼Œè€Œä¿è¯ View å’Œ Modal åŒæ­¥çš„æ˜¯ View-Modalã€‚")]),t._v(" "),a("p",[t._v("Vue é€šè¿‡ä¸€ä¸ª"),a("a",{attrs:{href:"https://cn.vuejs.org/v2/guide/reactivity.html#ad",target:"_blank",rel:"noopener noreferrer"}},[t._v("å“åº”å¼ç³»ç»Ÿ"),a("OutboundLink")],1),t._v("ä¿è¯äº†View ä¸ Modalçš„åŒæ­¥,ç”±äºè¦å…¼å®¹IE,Vue é€‰æ‹©äº† "),a("code",[t._v("Object.defineProperty")]),t._v("ä½œä¸ºå“åº”å¼ç³»ç»Ÿçš„å®ç°,ä½†æ˜¯å¦‚æœä¸è€ƒè™‘ IE ç”¨æˆ·çš„è¯,"),a("code",[t._v("Object.defineProperty")]),t._v("å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©,å…·ä½“è¯·çœ‹"),a("a",{attrs:{href:"https://juejin.im/post/5acd0c8a6fb9a028da7cdfaf",target:"_blank",rel:"noopener noreferrer"}},[t._v("**å®˜ç³»åˆ—(4): åŸºäºProxy æ•°æ®åŠ«æŒçš„åŒå‘ç»‘å®šä¼˜åŠ¿æ‰€åœ¨"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å°†ç”¨ Proxy å®ç°ä¸€ä¸ªå“åº”å¼ç³»ç»Ÿã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/6/6/163d41869ea10f6d?w=750&h=390&f=png&s=33203",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("å»ºè®®é˜…è¯»ä¹‹å‰çœ‹ä¸€ä¸‹"),a("a",{attrs:{href:"https://juejin.im/post/5acd0c8a6fb9a028da7cdfaf",target:"_blank",rel:"noopener noreferrer"}},[t._v("**å®˜ç³»åˆ—(4): åŸºäºProxy æ•°æ®åŠ«æŒçš„åŒå‘ç»‘å®šä¼˜åŠ¿æ‰€åœ¨"),a("OutboundLink")],1),t._v("ä¸­åŸºäº"),a("code",[t._v("Object.defineProperty")]),t._v("çš„å¤§è‡´å®ç°ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"å‘å¸ƒè®¢é˜…ä¸­å¿ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‘å¸ƒè®¢é˜…ä¸­å¿ƒ","aria-hidden":"true"}},[t._v("#")]),t._v(" å‘å¸ƒè®¢é˜…ä¸­å¿ƒ")]),t._v(" "),a("p",[t._v("ä¸€ä¸ªå“åº”å¼ç³»ç»Ÿç¦»ä¸å¼€å‘å¸ƒè®¢é˜…æ¨¡å¼,å› ä¸ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ª "),a("code",[t._v("Dep")]),t._v("ä¿å­˜è®¢é˜…è€…,å¹¶åœ¨ Observer å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥ä¿å­˜åœ¨ Dep ä¸­çš„è®¢é˜…è€…,è®©è®¢é˜…è€…å¾—çŸ¥å˜åŒ–å¹¶æ›´æ–°è§†å›¾,è¿™æ ·æ‰èƒ½ä¿è¯è§†å›¾ä¸çŠ¶æ€çš„åŒæ­¥ã€‚")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * [subs description] è®¢é˜…å™¨,å‚¨å­˜è®¢é˜…è€…,é€šçŸ¥è®¢é˜…è€…\n * @type {Map}\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æˆ‘ä»¬ç”¨ hash å‚¨å­˜è®¢é˜…è€…")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ·»åŠ è®¢é˜…è€…")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å–å‡ºé”®ä¸º key çš„è®¢é˜…è€…")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" currentSub "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœèƒ½å–å‡ºè¯´æ˜æœ‰ç›¸åŒçš„ key çš„è®¢é˜…è€…å·²ç»å­˜åœ¨,ç›´æ¥æ·»åŠ ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentSub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      currentSub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨ Set æ•°æ®ç»“æ„å‚¨å­˜,ä¿è¯å”¯ä¸€å€¼")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é€šçŸ¥")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è§¦å‘é”®ä¸º key çš„è®¢é˜…è€…ä»¬")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("sub")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"ç›‘å¬è€…çš„å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç›‘å¬è€…çš„å®ç°","aria-hidden":"true"}},[t._v("#")]),t._v(" ç›‘å¬è€…çš„å®ç°")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬åœ¨è®¢é˜…å™¨ "),a("code",[t._v("Dep")]),t._v(" ä¸­å®ç°äº†ä¸€ä¸ª"),a("code",[t._v("notify")]),t._v("æ–¹æ³•æ¥é€šçŸ¥ç›¸åº”çš„è®¢é˜…è¿™ä»¬,ç„¶è€Œ"),a("code",[t._v("notify")]),t._v("æ–¹æ³•åˆ°åº•ä»€ä¹ˆæ—¶å€™è¢«è§¦å‘å‘¢?")]),t._v(" "),a("p",[t._v("å½“ç„¶æ˜¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶,å³ MVVM ä¸­çš„ Modal å˜åŒ–æ—¶è§¦å‘é€šçŸ¥,ç„¶è€Œ"),a("code",[t._v("Dep")]),t._v(" æ˜¾ç„¶æ— æ³•å¾—çŸ¥ Modal æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–,å› æ­¤æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç›‘å¬è€…"),a("code",[t._v("Observer")]),t._v("æ¥ç›‘å¬ Modal, å½“ Modal å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æˆ‘ä»¬å°±æ‰§è¡Œé€šçŸ¥æ“ä½œã€‚")]),t._v(" "),a("p",[t._v("vue åŸºäº"),a("code",[t._v("Object.defineProperty")]),t._v("æ¥å®ç°äº†ç›‘å¬è€…ï¼Œæˆ‘ä»¬ç”¨ Proxy æ¥å®ç°ç›‘å¬è€….")]),t._v(" "),a("p",[t._v("ä¸"),a("code",[t._v("Object.defineProperty")]),t._v("ç›‘å¬å±æ€§ä¸åŒ, Proxy å¯ä»¥ç›‘å¬(å®é™…æ˜¯ä»£ç†)æ•´ä¸ªå¯¹è±¡,å› æ­¤å°±ä¸éœ€è¦éå†å¯¹è±¡çš„å±æ€§ä¾æ¬¡ç›‘å¬äº†,ä½†æ˜¯å¦‚æœå¯¹è±¡çš„å±æ€§ä¾ç„¶æ˜¯ä¸ªå¯¹è±¡,é‚£ä¹ˆ Proxy ä¹Ÿæ— æ³•ç›‘å¬,æ‰€ä»¥æˆ‘ä»¬å®ç°äº†ä¸€ä¸ª"),a("code",[t._v("observify")]),t._v("è¿›è¡Œé€’å½’ç›‘å¬å³å¯ã€‚")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * [Observer description] ç›‘å¬å™¨,ç›‘å¬å¯¹è±¡,è§¦å‘åé€šçŸ¥è®¢é˜…\n * @param {[type]}   obj [description] éœ€è¦è¢«ç›‘å¬çš„å¯¹è±¡\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("Observer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœè®¢é˜…è€…å­˜åœ¨ï¼Œç›´æ¥æ·»åŠ è®¢é˜…")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœå¯¹è±¡å€¼æ²¡æœ‰å˜,é‚£ä¹ˆä¸è§¦å‘ä¸‹é¢çš„æ“ä½œç›´æ¥è¿”å›    ")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å€¼è¢«è§¦å‘æ›´æ”¹çš„æ—¶å€™,è§¦å‘ Dep çš„é€šçŸ¥æ–¹æ³•")]),t._v("\n      dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * å°†å¯¹è±¡è½¬ä¸ºç›‘å¬å¯¹è±¡\n * @param {*} obj è¦ç›‘å¬çš„å¯¹è±¡\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ·±åº¦ç›‘å¬")]),t._v("\n  Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("keys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Observer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"è®¢é˜…è€…çš„å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¢é˜…è€…çš„å®ç°","aria-hidden":"true"}},[t._v("#")]),t._v(" è®¢é˜…è€…çš„å®ç°")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬ç›®å‰å·²ç»è§£å†³äº†ä¸¤ä¸ªé—®é¢˜,ä¸€ä¸ªæ˜¯å¦‚ä½•å¾—çŸ¥ Modal å‘ç”Ÿäº†æ”¹å˜(åˆ©ç”¨ç›‘å¬è€… Observer ç›‘å¬ Modal å¯¹è±¡),ä¸€ä¸ªæ˜¯å¦‚ä½•æ”¶é›†è®¢é˜…è€…å¹¶é€šçŸ¥å…¶å˜åŒ–(åˆ©ç”¨è®¢é˜…å™¨æ”¶é›†è®¢é˜…è€…,å¹¶ç”¨notifyé€šçŸ¥è®¢é˜…è€…)ã€‚")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬ç›®å‰è¿˜å·®ä¸€ä¸ªè®¢é˜…è€…ï¼ˆWatcherï¼‰")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¢é˜…è€…")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vm æ˜¯ vue çš„å®ä¾‹")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¢«è®¢é˜…çš„æ•°æ®")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è§¦å‘æ›´æ–°åçš„å›è°ƒ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–è€æ•°æ®")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    Dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("exp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" exp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    Dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°†è®¢é˜…è€…æ”¾å…¥å¾…æ›´æ–°é˜Ÿåˆ—ç­‰å¾…æ‰¹é‡æ›´æ–°")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushQueue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è§¦å‘çœŸæ­£çš„æ›´æ–°æ“ä½œ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" val "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–æ–°æ•°æ®")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"æ‰¹é‡æ›´æ–°çš„å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‰¹é‡æ›´æ–°çš„å®ç°","aria-hidden":"true"}},[t._v("#")]),t._v(" æ‰¹é‡æ›´æ–°çš„å®ç°")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­å®ç°äº†è®¢é˜…è€…( Watcher),ä½†æ˜¯å…¶ä¸­çš„"),a("code",[t._v("update")]),t._v("æ–¹æ³•æ˜¯å°†è®¢é˜…è€…æ”¾å…¥äº†ä¸€ä¸ªå¾…æ›´æ–°çš„é˜Ÿåˆ—ä¸­,è€Œä¸æ˜¯ç›´æ¥è§¦å‘,åŸå› å¦‚ä¸‹:\n"),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/6/6/163d44b791377e87?w=693&h=380&f=png&s=139764",alt:""}})]),t._v(" "),a("p",[t._v("å› æ­¤è¿™ä¸ªé˜Ÿåˆ—éœ€è¦åšçš„æ˜¯"),a("strong",[t._v("å¼‚æ­¥")]),t._v("ä¸”"),a("strong",[t._v("å»é‡")]),t._v(",å› æ­¤æˆ‘ä»¬ç”¨ "),a("code",[t._v("Set")]),t._v("ä½œä¸ºæ•°æ®ç»“æ„å‚¨å­˜ Watcher æ¥å»é‡,åŒæ—¶ç”¨"),a("code",[t._v("Promise")]),t._v("æ¨¡æ‹Ÿå¼‚æ­¥æ›´æ–°ã€‚")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºå¼‚æ­¥æ›´æ–°é˜Ÿåˆ—")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" queue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨Promiseæ¨¡æ‹ŸnextTick")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œåˆ·æ–°é˜Ÿåˆ—")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("flushQueue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("watcher")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¸…ç©º")]),t._v("\n    queue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ·»åŠ åˆ°é˜Ÿåˆ—")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pushQueue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("watcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸‹ä¸€ä¸ªå¾ªç¯è°ƒç”¨")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"æ¢³ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¢³ç†","aria-hidden":"true"}},[t._v("#")]),t._v(" æ¢³ç†")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬æ¢³ç†ä¸€ä¸‹æµç¨‹, ä¸€ä¸ªå“åº”å¼ç³»ç»Ÿæ˜¯å¦‚ä½•åšåˆ° UI(View)ä¸çŠ¶æ€(Modal)åŒæ­¥çš„?")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬é¦–å…ˆéœ€è¦ç›‘å¬ Modal, æœ¬æ–‡ä¸­æˆ‘ä»¬ç”¨ Proxy æ¥ç›‘å¬äº† Modal å¯¹è±¡,å› æ­¤åœ¨ Modal å¯¹è±¡è¢«ä¿®æ”¹çš„æ—¶å€™æˆ‘ä»¬çš„ Observer å°±å¯ä»¥å¾—çŸ¥ã€‚")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å¾—çŸ¥Modalå‘ç”Ÿå˜åŒ–åå¦‚ä½•é€šçŸ¥ View å‘¢ï¼Ÿè¦çŸ¥é“ï¼Œä¸€ä¸ª Modal çš„æ”¹å˜å¯èƒ½è§¦å‘å¤šä¸ª UI çš„æ›´æ–°ï¼Œæ¯”å¦‚ä¸€ä¸ªç”¨æˆ·çš„ç”¨æˆ·åæ”¹å˜äº†ï¼Œå®ƒçš„ä¸ªäººä¿¡æ¯ç»„ä»¶ã€é€šçŸ¥ç»„ä»¶ç­‰ç­‰ç»„ä»¶ä¸­çš„ç”¨æˆ·åéƒ½éœ€è¦æ”¹å˜ï¼Œå¯¹äºè¿™ç§æƒ…å†µæˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°åˆ©ç”¨"),a("strong",[t._v("å‘å¸ƒè®¢é˜…")]),t._v("æ¨¡å¼æ¥è§£å†³,æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè®¢é˜…å™¨(Dep)æ¥å‚¨å­˜è®¢é˜…è€…(Watcher),å½“ç›‘å¬åˆ° Modal æ”¹å˜æ—¶,æˆ‘ä»¬åªéœ€è¦é€šçŸ¥ç›¸å…³çš„è®¢é˜…è€…è¿›è¡Œæ›´æ–°å³å¯ã€‚")]),t._v(" "),a("p",[t._v("é‚£ä¹ˆè®¢é˜…è€…æ¥è‡ªå“ªé‡Œå‘¢ï¼Ÿå…¶å®æ¯ä¸€ä¸ªç»„ä»¶å®ä¾‹å¯¹åº”ç€ä¸€ä¸ªè®¢é˜…è€…ï¼ˆæ­£å› ä¸ºä¸€ä¸ªç»„ä»¶å®ä¾‹å¯¹åº”ä¸€ä¸ªè®¢é˜…è€…ï¼Œæ‰èƒ½åˆ©ç”¨ Dep é€šçŸ¥åˆ°ç›¸åº”ç»„ä»¶ï¼Œä¸ç„¶ä¹±å¥—äº†ï¼Œé€šçŸ¥è®¢é˜…è€…å°±ç›¸å½“äºé—´æ¥é€šçŸ¥äº†ç»„ä»¶ï¼‰ã€‚")]),t._v(" "),a("p",[t._v("å½“è®¢é˜…è€…å¾—çŸ¥äº†å…·ä½“å˜åŒ–åå®ƒä¼šè¿›è¡Œç›¸åº”çš„æ›´æ–°,å°†æ›´æ–°ä½“ç°åœ¨ UI(View)ä¸Š,è‡³æ­¤UI ä¸ Modal çš„åŒæ­¥å®Œæˆäº†ã€‚")]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://github.com/xiaomuzhu/proxy-vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("å®Œæ•´ä»£ç "),a("OutboundLink")],1),t._v("å·²ç»åœ¨ github ä¸Š,ç›®å‰åªå®ç°äº†ä¸€ä¸ªå“åº”å¼ç³»ç»Ÿ,æ¥ä¸‹æ¥ä¼šé€æ­¥å®ç°ä¸€ä¸ªå®Œæ•´çš„è¿·ä½ ç‰ˆ mvvm æ¡†æ¶,æ‰€ä»¥ä½ å¯ä»¥ star æˆ–è€… watch æ¥å…³æ³¨è¿›åº¦.")])]),t._v(" "),a("h2",{attrs:{id:"å“åº”å¼ç³»ç»Ÿå¹¶ä¸æ˜¯å…¨éƒ¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“åº”å¼ç³»ç»Ÿå¹¶ä¸æ˜¯å…¨éƒ¨","aria-hidden":"true"}},[t._v("#")]),t._v(" å“åº”å¼ç³»ç»Ÿå¹¶ä¸æ˜¯å…¨éƒ¨")]),t._v(" "),a("p",[t._v("å“åº”å¼ç³»ç»Ÿè™½ç„¶æ˜¯ Vue çš„æ ¸å¿ƒæ¦‚å¿µ,ä½†æ˜¯ä¸€ä¸ªå“åº”å¼ç³»ç»Ÿå¹¶ä¸å¤Ÿ.")]),t._v(" "),a("p",[t._v("å“åº”å¼ç³»ç»Ÿè™½ç„¶å¾—çŸ¥äº†æ•°æ®å€¼çš„å˜åŒ–,ä½†æ˜¯å½“å€¼ä¸èƒ½å®Œæ•´æ˜ å°„ UI æ—¶,æˆ‘ä»¬ä¾ç„¶éœ€è¦è¿›è¡Œç»„ä»¶çº§åˆ«çš„ reRender,è¿™ç§æƒ…å†µå¹¶ä¸é«˜æ•ˆ,å› æ­¤ Vue åœ¨2.0ç‰ˆæœ¬å¼•å…¥äº†è™šæ‹Ÿ DOM, è™šæ‹Ÿ DOMè¿›è¡Œè¿›ä¸€æ­¥çš„ diff æ“ä½œå¯ä»¥è¿›è¡Œç»†ç²’åº¦æ›´é«˜çš„æ“ä½œ,å¯ä»¥ä¿è¯ reReander çš„ä¸‹é™(ä¿è¯ä¸é‚£ä¹ˆæ…¢)ã€‚")]),t._v(" "),a("p",[t._v("é™¤æ­¤ä¹‹å¤–ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ï¼Œvue å†…ç½®äº†ä¼—å¤šçš„æŒ‡ä»¤ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª vue æ¨¡æ¿è§£æå™¨.")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"å…¬ä¼—å·"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…¬ä¼—å·","aria-hidden":"true"}},[t._v("#")]),t._v(" å…¬ä¼—å·")]),t._v(" "),a("p",[t._v("æƒ³è¦å®æ—¶å…³æ³¨ç¬”è€…æœ€æ–°çš„æ–‡ç« å’Œæœ€æ–°çš„æ–‡æ¡£æ›´æ–°è¯·å…³æ³¨å…¬ä¼—å·"),a("strong",[t._v("ç¨‹åºå‘˜")]),t._v("å®˜**,åç»­çš„æ–‡ç« ä¼šä¼˜å…ˆåœ¨å…¬ä¼—å·æ›´æ–°.")]),t._v(" "),a("p",[a("strong",[t._v("ç®€å†æ¨¡æ¿:")]),t._v(" å…³æ³¨å…¬ä¼—å·å›å¤ã€Œæ¨¡æ¿ã€è·å–")]),t._v(" "),a("p",[a("strong",[t._v("ã€Šå‰ç«¯")]),t._v("æ‰‹å†Œã€‹ğŸ˜—* é…å¥—äºæœ¬æŒ‡å—çš„çªå‡»æ‰‹å†Œ,å…³æ³¨å…¬ä¼—å·å›å¤ã€Œfedã€è·å–")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://xiaomuzhu-image.oss-cn-beijing.aliyuncs.com/d846f65d5025c4b6c4619662a0669503.png",alt:"2019-08-12-03-18-41"}})])])},[],!1,null,null,null);s.default=e.exports}}]);