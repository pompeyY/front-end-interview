<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¦‚ä½•å®ç°ä¸€ä¸ªEvent | å‰ç«¯æŒ‡å—</title>
    <meta name="description" content="å¯èƒ½æ˜¯å…¨ç½‘æœ€ç»™åŠ›çš„å‰ç«¯**é¡¹ç›®">
    <link rel="icon" href="/front-end-interview/logo.svg">
  <link rel="manifest" href="/front-end-interview/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/front-end-interview/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/front-end-interview/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/front-end-interview/assets/css/0.styles.1d2d370d.css" as="style"><link rel="preload" href="/front-end-interview/assets/js/app.cf4632d5.js" as="script"><link rel="preload" href="/front-end-interview/assets/js/3.27562796.js" as="script"><link rel="preload" href="/front-end-interview/assets/js/34.c2dc7fd1.js" as="script"><link rel="preload" href="/front-end-interview/assets/js/6.4cd0594d.js" as="script"><link rel="prefetch" href="/front-end-interview/assets/js/10.ef2ef882.js"><link rel="prefetch" href="/front-end-interview/assets/js/11.bea478d7.js"><link rel="prefetch" href="/front-end-interview/assets/js/12.e2c9f81b.js"><link rel="prefetch" href="/front-end-interview/assets/js/13.b9ab188f.js"><link rel="prefetch" href="/front-end-interview/assets/js/14.53ff4e99.js"><link rel="prefetch" href="/front-end-interview/assets/js/15.04097571.js"><link rel="prefetch" href="/front-end-interview/assets/js/16.0f3a1d96.js"><link rel="prefetch" href="/front-end-interview/assets/js/17.afa53695.js"><link rel="prefetch" href="/front-end-interview/assets/js/18.6e6404df.js"><link rel="prefetch" href="/front-end-interview/assets/js/19.7fc2e8e6.js"><link rel="prefetch" href="/front-end-interview/assets/js/20.98e939c4.js"><link rel="prefetch" href="/front-end-interview/assets/js/21.df9761e8.js"><link rel="prefetch" href="/front-end-interview/assets/js/22.1514b966.js"><link rel="prefetch" href="/front-end-interview/assets/js/23.4d744d84.js"><link rel="prefetch" href="/front-end-interview/assets/js/24.8510fdb1.js"><link rel="prefetch" href="/front-end-interview/assets/js/25.8075ced6.js"><link rel="prefetch" href="/front-end-interview/assets/js/26.aedd08f0.js"><link rel="prefetch" href="/front-end-interview/assets/js/27.f02badf7.js"><link rel="prefetch" href="/front-end-interview/assets/js/28.78265b56.js"><link rel="prefetch" href="/front-end-interview/assets/js/29.1f709421.js"><link rel="prefetch" href="/front-end-interview/assets/js/30.15a614dc.js"><link rel="prefetch" href="/front-end-interview/assets/js/31.1dc8297d.js"><link rel="prefetch" href="/front-end-interview/assets/js/32.30fe2812.js"><link rel="prefetch" href="/front-end-interview/assets/js/33.e25aed7f.js"><link rel="prefetch" href="/front-end-interview/assets/js/35.4c64e759.js"><link rel="prefetch" href="/front-end-interview/assets/js/36.8fae845b.js"><link rel="prefetch" href="/front-end-interview/assets/js/37.9f5b3f94.js"><link rel="prefetch" href="/front-end-interview/assets/js/38.cd15aba3.js"><link rel="prefetch" href="/front-end-interview/assets/js/39.6fc63db5.js"><link rel="prefetch" href="/front-end-interview/assets/js/4.c046c865.js"><link rel="prefetch" href="/front-end-interview/assets/js/40.c843d97d.js"><link rel="prefetch" href="/front-end-interview/assets/js/41.f8d8f9ab.js"><link rel="prefetch" href="/front-end-interview/assets/js/42.98793d20.js"><link rel="prefetch" href="/front-end-interview/assets/js/43.0167ed9b.js"><link rel="prefetch" href="/front-end-interview/assets/js/44.c6482179.js"><link rel="prefetch" href="/front-end-interview/assets/js/45.9f28912b.js"><link rel="prefetch" href="/front-end-interview/assets/js/46.66f1a039.js"><link rel="prefetch" href="/front-end-interview/assets/js/47.a82a23db.js"><link rel="prefetch" href="/front-end-interview/assets/js/48.42e6d64e.js"><link rel="prefetch" href="/front-end-interview/assets/js/49.0d583eef.js"><link rel="prefetch" href="/front-end-interview/assets/js/5.e60c7edb.js"><link rel="prefetch" href="/front-end-interview/assets/js/50.cbd1d62e.js"><link rel="prefetch" href="/front-end-interview/assets/js/51.52304a95.js"><link rel="prefetch" href="/front-end-interview/assets/js/52.939e70a5.js"><link rel="prefetch" href="/front-end-interview/assets/js/53.d2cc0a31.js"><link rel="prefetch" href="/front-end-interview/assets/js/54.810e208e.js"><link rel="prefetch" href="/front-end-interview/assets/js/55.a487c9e9.js"><link rel="prefetch" href="/front-end-interview/assets/js/56.349e0a41.js"><link rel="prefetch" href="/front-end-interview/assets/js/57.3274cf86.js"><link rel="prefetch" href="/front-end-interview/assets/js/58.bd0c916e.js"><link rel="prefetch" href="/front-end-interview/assets/js/59.e6a5107d.js"><link rel="prefetch" href="/front-end-interview/assets/js/60.d6439c70.js"><link rel="prefetch" href="/front-end-interview/assets/js/61.be2fd65c.js"><link rel="prefetch" href="/front-end-interview/assets/js/62.4e251f9d.js"><link rel="prefetch" href="/front-end-interview/assets/js/63.b694b324.js"><link rel="prefetch" href="/front-end-interview/assets/js/64.195f914b.js"><link rel="prefetch" href="/front-end-interview/assets/js/65.ad9ef366.js"><link rel="prefetch" href="/front-end-interview/assets/js/66.c7cb7e31.js"><link rel="prefetch" href="/front-end-interview/assets/js/67.1d3e9295.js"><link rel="prefetch" href="/front-end-interview/assets/js/68.b78fb449.js"><link rel="prefetch" href="/front-end-interview/assets/js/69.092f9c93.js"><link rel="prefetch" href="/front-end-interview/assets/js/7.f7fb530c.js"><link rel="prefetch" href="/front-end-interview/assets/js/70.4463ac0f.js"><link rel="prefetch" href="/front-end-interview/assets/js/8.6c131b05.js"><link rel="prefetch" href="/front-end-interview/assets/js/9.6a58b3ec.js"><link rel="prefetch" href="/front-end-interview/assets/js/vendors~notification.b8581b7d.js">
    <link rel="stylesheet" href="/front-end-interview/assets/css/0.styles.1d2d370d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front-end-interview/" class="home-link router-link-active"><!----> <span class="site-name">å‰ç«¯æŒ‡å—</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front-end-interview/guide/" class="nav-link router-link-active">æŒ‡å—</a></div> <a href="https://github.com/xiaomuzhu/front-end-interview" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front-end-interview/guide/" class="nav-link router-link-active">æŒ‡å—</a></div> <a href="https://github.com/xiaomuzhu/front-end-interview" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰è¨€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/" class="sidebar-link">æŒ‡å—ä½¿ç”¨æ‰‹å†Œ</a></li><li><a href="/front-end-interview/guide/preface.html" class="sidebar-link">ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé¡¹ç›®</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>**æŠ€å·§</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/resume.html" class="sidebar-link">**å®˜åˆ°åº•æƒ³çœ‹ä»€ä¹ˆæ ·çš„ç®€å†ï¼Ÿ</a></li><li><a href="/front-end-interview/guide/project.html" class="sidebar-link">**å›ç­”é—®é¢˜çš„æŠ€å·§</a></li><li><a href="/front-end-interview/guide/hr.html" class="sidebar-link">å¦‚ä½•é€šè¿‡HRé¢</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ¨è</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/book.html" class="sidebar-link">ä¹¦ç±/è¯¾ç¨‹æ¨è</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯åŸºç¡€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/htmlBasic.html" class="sidebar-link">HTMLåŸºç¡€</a></li><li><a href="/front-end-interview/guide/cssBasic.html" class="sidebar-link">CSSåŸºç¡€</a></li><li><a href="/front-end-interview/guide/jsBasic.html" class="sidebar-link">JavaScriptåŸºç¡€</a></li><li><a href="/front-end-interview/guide/browser.html" class="sidebar-link">æµè§ˆå™¨ä¸æ–°æŠ€æœ¯</a></li><li><a href="/front-end-interview/guide/dom.html" class="sidebar-link">DOM</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯åŸºç¡€ç¬”è¯•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/httpWritten.html" class="sidebar-link">HTTPç¬”è¯•éƒ¨åˆ†</a></li><li><a href="/front-end-interview/guide/jsWritten.html" class="sidebar-link">JavaScriptç¬”è¯•éƒ¨åˆ†</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰ç«¯åŸç†è¯¦è§£</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/hoisting.html" class="sidebar-link">JavaScriptçš„ã€é¢„è§£é‡Šã€ä¸ã€å˜é‡æå‡ã€</a></li><li><a href="/front-end-interview/guide/eventLoop.html" class="sidebar-link">Event Loopè¯¦è§£</a></li><li><a href="/front-end-interview/guide/immutable.html" class="sidebar-link">å®ç°ä¸å¯å˜æ•°æ®</a></li><li><a href="/front-end-interview/guide/memory.html" class="sidebar-link">JavaScriptå†…å­˜ç®¡ç†</a></li><li><a href="/front-end-interview/guide/deepclone.html" class="sidebar-link">å®ç°æ·±å…‹éš†</a></li><li><a href="/front-end-interview/guide/event.html" class="active sidebar-link">å¦‚ä½•å®ç°ä¸€ä¸ªEvent</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front-end-interview/guide/event.html#å‰è¨€" class="sidebar-link">å‰è¨€</a></li><li class="sidebar-sub-header"><a href="/front-end-interview/guide/event.html#åŸºæœ¬æ„é€ " class="sidebar-link">åŸºæœ¬æ„é€ </a></li><li class="sidebar-sub-header"><a href="/front-end-interview/guide/event.html#å‡çº§æ”¹é€ " class="sidebar-link">å‡çº§æ”¹é€ </a></li><li class="sidebar-sub-header"><a href="/front-end-interview/guide/event.html#å…¬ä¼—å·" class="sidebar-link">å…¬ä¼—å·</a></li></ul></li><li><a href="/front-end-interview/guide/mechanism.html" class="sidebar-link">JavaScriptçš„è¿è¡Œæœºåˆ¶</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è®¡ç®—æœºåŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ•°æ®ç»“æ„ä¸ç®—æ³•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/algorithm.html" class="sidebar-link">ç®—æ³•**é¢˜</a></li><li><a href="/front-end-interview/guide/string.html" class="sidebar-link">å­—ç¬¦ä¸²ç±»**é¢˜</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‰ç«¯æ¡†æ¶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end-interview/guide/framework.html" class="sidebar-link">å…³äºå‰ç«¯æ¡†æ¶çš„**é¡»çŸ¥</a></li><li><a href="/front-end-interview/guide/vue.html" class="sidebar-link">Vue**é¢˜</a></li><li><a href="/front-end-interview/guide/react.html" class="sidebar-link">React**é¢˜</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¡†æ¶åŸç†è¯¦è§£</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¡†æ¶å®æˆ˜æŠ€å·§</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ€§èƒ½ä¼˜åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å·¥ç¨‹åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å·¥ç¨‹åŒ–åŸç†</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®‰å…¨</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="å¦‚ä½•å®ç°ä¸€ä¸ªevent"><a href="#å¦‚ä½•å®ç°ä¸€ä¸ªevent" aria-hidden="true" class="header-anchor">#</a> å¦‚ä½•å®ç°ä¸€ä¸ªEvent</h1> <p>ç‚¹å‡»å…³æ³¨æœ¬<a href="#%E5%85%AC%E4%BC%97%E5%8F%B7">å…¬ä¼—å·</a>è·å–æ–‡æ¡£æœ€æ–°æ›´æ–°,å¹¶å¯ä»¥é¢†å–é…å¥—äºæœ¬æŒ‡å—çš„ <strong>ã€Šå‰ç«¯</strong>æ‰‹å†Œã€‹** ä»¥åŠ<strong>æœ€æ ‡å‡†çš„ç®€å†æ¨¡æ¿</strong>.</p> <h2 id="å‰è¨€"><a href="#å‰è¨€" aria-hidden="true" class="header-anchor">#</a> å‰è¨€</h2> <p>æœ¬æ–‡æ ‡é¢˜çš„é¢˜ç›®æ˜¯ç”±å…¶ä»–é—®é¢˜å»¶ä¼¸è€Œæ¥,<strong>ä¸­</strong>å®˜çš„å¸¸ç”¨å¥—è·¯,æªä½ä¸€ä¸ªé—®é¢˜ä¸€ç›´æ·±æŒ–,åœ¨äº§ç”Ÿè¿™ä¸ªé—®é¢˜ä¹‹å‰ä¸€å®šæ˜¯è¿™ä¸ªé—®é¢˜.</p> <blockquote><p>React/Vueä¸åŒç»„ä»¶ä¹‹é—´æ˜¯æ€ä¹ˆé€šä¿¡çš„?</p></blockquote> <p><strong>Vue</strong></p> <ol><li>çˆ¶å­ç»„ä»¶ç”¨Propsé€šä¿¡</li> <li>éçˆ¶å­ç»„ä»¶ç”¨Event Busé€šä¿¡</li> <li>å¦‚æœé¡¹ç›®å¤Ÿå¤æ‚,å¯èƒ½éœ€è¦Vuexç­‰å…¨å±€çŠ¶æ€ç®¡ç†åº“é€šä¿¡</li> <li><code>$dispatch</code>(å·²ç»åºŸé™¤)å’Œ<code>$broadcast</code>(å·²ç»åºŸé™¤)</li></ol> <p><strong>React</strong></p> <ol><li>çˆ¶å­ç»„ä»¶,çˆ¶-&gt;å­ç›´æ¥ç”¨Props,å­-&gt;çˆ¶ç”¨callbackå›è°ƒ</li> <li>éçˆ¶å­ç»„ä»¶,ç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼çš„Eventæ¨¡å—</li> <li>é¡¹ç›®å¤æ‚çš„è¯ç”¨Reduxã€Mobxç­‰å…¨å±€çŠ¶æ€ç®¡ç†ç®¡åº“</li> <li>ç”¨æ–°çš„<a href="https://juejin.im/post/5a7b41605188257a6310fbec" target="_blank" rel="noopener noreferrer">Context Api<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <p>æˆ‘ä»¬å¤§ä½“ä¸Šéƒ½ä¼šæœ‰ä»¥ä¸Šå›ç­”,æ¥ä¸‹æ¥å¾ˆå¯èƒ½ä¼šé—®åˆ°å¦‚ä½•å®ç°<code>Event(Bus)</code>,å› ä¸ºè¿™ä¸ªä¸œè¥¿å¤ªé‡è¦äº†,å‡ ä¹æ‰€æœ‰çš„æ¨¡å—é€šä¿¡éƒ½æ˜¯åŸºäºç±»ä¼¼çš„æ¨¡å¼,åŒ…æ‹¬å®‰å“å¼€å‘ä¸­çš„<code>Event Bus</code>,Node.jsä¸­çš„<code>Event</code>æ¨¡å—(Nodeä¸­å‡ ä¹æ‰€æœ‰çš„æ¨¡å—éƒ½ä¾èµ–äºEvent,åŒ…æ‹¬ä¸é™äº<code>httpã€streamã€bufferã€fs</code>ç­‰).</p> <p>æˆ‘ä»¬ä»¿ç…§Nodeä¸­<a href="http://nodejs.cn/api/events.html" target="_blank" rel="noopener noreferrer">Event API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>å®ç°ä¸€ä¸ªç®€å•çš„Eventåº“,ä»–æ˜¯<strong>å‘å¸ƒè®¢é˜…æ¨¡å¼</strong>çš„å…¸å‹åº”ç”¨.</p> <blockquote><p><strong>æå‰å£°æ˜:</strong> æˆ‘ä»¬æ²¡æœ‰å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡ŒåŠæ—¶åˆ¤æ–­è€Œè§„é¿é”™è¯¯,ä»…ä»…å¯¹æ ¸å¿ƒæ–¹æ³•è¿›è¡Œäº†å®ç°.</p></blockquote> <h2 id="åŸºæœ¬æ„é€ "><a href="#åŸºæœ¬æ„é€ " aria-hidden="true" class="header-anchor">#</a> åŸºæœ¬æ„é€ </h2> <h3 id="åˆå§‹åŒ–class"><a href="#åˆå§‹åŒ–class" aria-hidden="true" class="header-anchor">#</a> åˆå§‹åŒ–class</h3> <p>æˆ‘ä»¬åˆ©ç”¨ES6çš„<code>class</code>å…³é”®å­—å¯¹<code>Event</code>è¿›è¡Œåˆå§‹åŒ–,åŒ…æ‹¬<code>Event</code>çš„äº‹ä»¶æ¸…å•å’Œç›‘å¬è€…ä¸Šé™.</p> <p>æˆ‘ä»¬é€‰æ‹©äº†<code>Map</code>ä½œä¸ºå‚¨å­˜äº‹ä»¶çš„ç»“æ„,å› ä¸ºä½œä¸ºé”®å€¼å¯¹çš„å‚¨å­˜æ–¹å¼<code>Map</code>æ¯”ä¸€èˆ¬å¯¹è±¡æ›´åŠ é€‚åˆ,æˆ‘ä»¬æ“ä½œèµ·æ¥ä¹Ÿæ›´åŠ ç®€æ´,å¯ä»¥å…ˆçœ‹ä¸€ä¸‹Mapçš„<a href="http://es6.ruanyifeng.com/#docs/set-map#Map" target="_blank" rel="noopener noreferrer">åŸºæœ¬ç”¨æ³•ä¸ç‰¹ç‚¹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">EventEmeitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_events <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å‚¨å­˜äº‹ä»¶/å›è°ƒé”®å€¼å¯¹</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_maxListeners <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_maxListeners <span class="token operator">||</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç«‹ç›‘å¬ä¸Šé™</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ç›‘å¬ä¸è§¦å‘"><a href="#ç›‘å¬ä¸è§¦å‘" aria-hidden="true" class="header-anchor">#</a> ç›‘å¬ä¸è§¦å‘</h3> <p>è§¦å‘ç›‘å¬å‡½æ•°æˆ‘ä»¬å¯ä»¥ç”¨<code>apply</code>ä¸<code>call</code>ä¸¤ç§æ–¹æ³•,åœ¨å°‘æ•°å‚æ•°æ—¶<code>call</code>çš„æ€§èƒ½æ›´å¥½,å¤šä¸ªå‚æ•°æ—¶<code>apply</code>æ€§èƒ½æ›´å¥½,å½“å¹´Nodeçš„Eventæ¨¡å—å°±åœ¨ä¸‰ä¸ªå‚æ•°ä»¥ä¸‹ç”¨<code>call</code>å¦åˆ™ç”¨<code>apply</code>.</p> <p>å½“ç„¶å½“Nodeå…¨é¢æ‹¥æŠ±ES6+ä¹‹å,ç›¸åº”çš„<code>call/apply</code>æ“ä½œç”¨<code>Reflect</code>æ–°å…³é”®å­—é‡å†™äº†,ä½†æ˜¯æˆ‘ä»¬ä¸æƒ³å†™çš„é‚£ä¹ˆå¤æ‚,å°±åšäº†ä¸€ä¸ªç®€åŒ–ç‰ˆ.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token comment">// è§¦å‘åä¸ºtypeçš„äº‹ä»¶</span>
<span class="token class-name">EventEmeitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">emit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> handler<span class="token punctuation">;</span>
  <span class="token comment">// ä»å‚¨å­˜äº‹ä»¶é”®å€¼å¯¹çš„this._eventsä¸­è·å–å¯¹åº”äº‹ä»¶å›è°ƒå‡½æ•°</span>
  handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ç›‘å¬åä¸ºtypeçš„äº‹ä»¶</span>
<span class="token class-name">EventEmeitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addListener</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å°†typeäº‹ä»¶ä»¥åŠå¯¹åº”çš„fnå‡½æ•°æ”¾å…¥this._eventsä¸­å‚¨å­˜</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>æˆ‘ä»¬å®ç°äº†è§¦å‘äº‹ä»¶çš„<code>emit</code>æ–¹æ³•å’Œç›‘å¬äº‹ä»¶çš„<code>addListener</code>æ–¹æ³•,è‡³æ­¤æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç®€å•çš„å®è·µäº†.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// å®ä¾‹åŒ–</span>
<span class="token keyword">const</span> emitter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmeitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç›‘å¬ä¸€ä¸ªåä¸ºarsonçš„äº‹ä»¶å¯¹åº”ä¸€ä¸ªå›è°ƒå‡½æ•°</span>
emitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token parameter">man</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`expel </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>man<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æˆ‘ä»¬è§¦å‘arsonäº‹ä»¶,å‘ç°å›è°ƒæˆåŠŸæ‰§è¡Œ</span>
emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token string">'low-end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// expel low-end</span>
</code></pre></div><p>ä¼¼ä¹ä¸é”™,æˆ‘ä»¬å®ç°äº†åŸºæœ¬çš„è§¦å‘/ç›‘å¬,ä½†æ˜¯å¦‚æœæœ‰å¤šä¸ªç›‘å¬è€…å‘¢?</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// é‡å¤ç›‘å¬åŒä¸€ä¸ªäº‹ä»¶å</span>
emitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token parameter">man</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`expel </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>man<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
emitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token parameter">man</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`save </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>man<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token string">'low-end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// expel low-end</span>
</code></pre></div><p>æ˜¯çš„,åªä¼šè§¦å‘ç¬¬ä¸€ä¸ª,å› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œæ”¹é€ .</p> <h2 id="å‡çº§æ”¹é€ "><a href="#å‡çº§æ”¹é€ " aria-hidden="true" class="header-anchor">#</a> å‡çº§æ”¹é€ </h2> <h3 id="ç›‘å¬-è§¦å‘å™¨å‡çº§"><a href="#ç›‘å¬-è§¦å‘å™¨å‡çº§" aria-hidden="true" class="header-anchor">#</a> ç›‘å¬/è§¦å‘å™¨å‡çº§</h3> <p>æˆ‘ä»¬çš„<code>addListener</code>å®ç°æ–¹æ³•è¿˜ä¸å¤Ÿå¥å…¨,åœ¨ç»‘å®šç¬¬ä¸€ä¸ªç›‘å¬è€…ä¹‹å,æˆ‘ä»¬å°±æ— æ³•å¯¹åç»­ç›‘å¬è€…è¿›è¡Œç»‘å®šäº†,å› æ­¤æˆ‘ä»¬éœ€è¦å°†åç»­ç›‘å¬è€…ä¸ç¬¬ä¸€ä¸ªç›‘å¬è€…å‡½æ•°æ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œ.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token comment">// è§¦å‘åä¸ºtypeçš„äº‹ä»¶</span>
<span class="token class-name">EventEmeitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">emit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> handler<span class="token punctuation">;</span>
  handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœæ˜¯ä¸€ä¸ªæ•°ç»„è¯´æ˜æœ‰å¤šä¸ªç›‘å¬è€…,éœ€è¦ä¾æ¬¡æ­¤è§¦å‘é‡Œé¢çš„å‡½æ•°</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> handler<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        handler<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        handler<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// å•ä¸ªå‡½æ•°çš„æƒ…å†µæˆ‘ä»¬ç›´æ¥è§¦å‘å³å¯</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">handler</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ç›‘å¬åä¸ºtypeçš„äº‹ä»¶</span>
<span class="token class-name">EventEmeitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addListener</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–å¯¹åº”äº‹ä»¶åç§°çš„å‡½æ•°æ¸…å•</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> handler <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœhandleræ˜¯å‡½æ•°è¯´æ˜åªæœ‰ä¸€ä¸ªç›‘å¬è€…</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token punctuation">[</span>handler<span class="token punctuation">,</span> fn<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¤šä¸ªç›‘å¬è€…æˆ‘ä»¬éœ€è¦ç”¨æ•°ç»„å‚¨å­˜</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    handler<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å·²ç»æœ‰å¤šä¸ªç›‘å¬è€…,é‚£ä¹ˆç›´æ¥å¾€æ•°ç»„é‡Œpushå‡½æ•°å³å¯</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>æ˜¯çš„,ä»æ­¤ä»¥åå¯ä»¥æ„‰å¿«çš„è§¦å‘å¤šä¸ªç›‘å¬è€…çš„å‡½æ•°äº†.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ç›‘å¬åŒä¸€ä¸ªäº‹ä»¶å</span>
emitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token parameter">man</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`expel </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>man<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
emitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token parameter">man</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`save </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>man<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

emitter<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token parameter">man</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`kill </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>man<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è§¦å‘äº‹ä»¶</span>
emitter<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'arson'</span><span class="token punctuation">,</span> <span class="token string">'low-end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//expel low-end</span>
<span class="token comment">//save low-end</span>
<span class="token comment">//kill low-end</span>
</code></pre></div><h3 id="ç§»é™¤ç›‘å¬"><a href="#ç§»é™¤ç›‘å¬" aria-hidden="true" class="header-anchor">#</a> ç§»é™¤ç›‘å¬</h3> <p>æˆ‘ä»¬ä¼šç”¨<code>removeListener</code>å‡½æ•°ç§»é™¤ç›‘å¬å‡½æ•°,ä½†æ˜¯åŒ¿åå‡½æ•°æ˜¯æ— æ³•ç§»é™¤çš„.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">EventEmeitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">removeListener</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–å¯¹åº”äº‹ä»¶åç§°çš„å‡½æ•°æ¸…å•</span>

  <span class="token comment">// å¦‚æœæ˜¯å‡½æ•°,è¯´æ˜åªè¢«ç›‘å¬äº†ä¸€æ¬¡</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> handler <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> postion<span class="token punctuation">;</span>
    <span class="token comment">// å¦‚æœhandleræ˜¯æ•°ç»„,è¯´æ˜è¢«ç›‘å¬å¤šæ¬¡è¦æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> handler<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>handler<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        postion <span class="token operator">=</span> i<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        postion <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¦‚æœæ‰¾åˆ°åŒ¹é…çš„å‡½æ•°,ä»æ•°ç»„ä¸­æ¸…é™¤</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>postion <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ‰¾åˆ°æ•°ç»„å¯¹åº”çš„ä½ç½®,ç›´æ¥æ¸…é™¤æ­¤å›è°ƒ</span>
      handler<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>postion<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å¦‚æœæ¸…é™¤ååªæœ‰ä¸€ä¸ªå‡½æ•°,é‚£ä¹ˆå–æ¶ˆæ•°ç»„,ä»¥å‡½æ•°å½¢å¼ä¿å­˜</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>handler<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> handler<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å‘ç°é—®é¢˜"><a href="#å‘ç°é—®é¢˜" aria-hidden="true" class="header-anchor">#</a> å‘ç°é—®é¢˜</h3> <p>æˆ‘ä»¬å·²ç»åŸºæœ¬å®Œæˆäº†<code>Event</code>æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•,ä¹Ÿå®Œæˆäº†å‡çº§æ”¹é€ ,å¯ä»¥è¯´ä¸€ä¸ª<code>Event</code>çš„éª¨æ¶æ˜¯è¢«æˆ‘ä»¬å¼€å‘å‡ºæ¥äº†,ä½†æ˜¯å®ƒä»ç„¶æœ‰ä¸è¶³å’Œéœ€è¦è¡¥å……çš„åœ°æ–¹.</p> <blockquote><ol><li>é²æ£’æ€§ä¸è¶³: æˆ‘ä»¬æ²¡æœ‰å¯¹å‚æ•°è¿›è¡Œå……åˆ†çš„åˆ¤æ–­,æ²¡æœ‰å®Œå–„çš„æŠ¥é”™æœºåˆ¶.</li> <li>æ¨¡æ‹Ÿä¸å¤Ÿå……åˆ†: é™¤äº†<code>removeAllListeners</code>è¿™äº›æ–¹æ³•æ²¡æœ‰å®ç°ä»¥å¤–,ä¾‹å¦‚ç›‘å¬æ—¶é—´åä¼šè§¦å‘<code>newListener</code>äº‹ä»¶,æˆ‘ä»¬ä¹Ÿæ²¡æœ‰å®ç°,å¦å¤–æœ€å¼€å§‹çš„ç›‘å¬è€…ä¸Šé™æˆ‘ä»¬ä¹Ÿæ²¡æœ‰åˆ©ç”¨åˆ°.</li></ol></blockquote> <p>å½“ç„¶,è¿™åœ¨<strong>ä¸­ç°åœºå†™ä¸€ä¸ªEventå·²ç»æ˜¯å¾ˆå¤Ÿæ„æ€äº†,ä¸»è¦æ˜¯ä½“ç°å‡ºæ¥å¯¹</strong>å‘å¸ƒ-è®¢é˜…**æ¨¡å¼çš„ç†è§£,ä»¥åŠé’ˆå¯¹å¤šä¸ªç›‘å¬çŠ¶å†µä¸‹çš„å¤„ç†,ä¸å¯èƒ½ç°åœºæ’¸å‡ ç™¾è¡Œå†™ä¸€ä¸ªå®Œæ•´Event.</p> <p>ç´¢æ€§<a href="https://github.com/Gozala/events/blob/master/events.js" target="_blank" rel="noopener noreferrer">Event<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>åº“å¸®æˆ‘ä»¬å®ç°äº†å®Œæ•´çš„ç‰¹æ€§,æ•´ä¸ªä»£ç é‡æœ‰300å¤šè¡Œ,å¾ˆé€‚åˆé˜…è¯»,ä½ å¯ä»¥èŠ±ååˆ†é’Ÿçš„æ—¶é—´é€šè¯»ä¸€ä¸‹,è§è¯†ä¸€ä¸‹å®Œæ•´çš„Eventå®ç°.</p> <hr> <h2 id="å…¬ä¼—å·"><a href="#å…¬ä¼—å·" aria-hidden="true" class="header-anchor">#</a> å…¬ä¼—å·</h2> <p>æƒ³è¦å®æ—¶å…³æ³¨ç¬”è€…æœ€æ–°çš„æ–‡ç« å’Œæœ€æ–°çš„æ–‡æ¡£æ›´æ–°è¯·å…³æ³¨å…¬ä¼—å·<strong>ç¨‹åºå‘˜</strong>å®˜**,åç»­çš„æ–‡ç« ä¼šä¼˜å…ˆåœ¨å…¬ä¼—å·æ›´æ–°.</p> <p><strong>ç®€å†æ¨¡æ¿:</strong> å…³æ³¨å…¬ä¼—å·å›å¤ã€Œæ¨¡æ¿ã€è·å–</p> <p><strong>ã€Šå‰ç«¯</strong>æ‰‹å†Œã€‹ğŸ˜—* é…å¥—äºæœ¬æŒ‡å—çš„çªå‡»æ‰‹å†Œ,å…³æ³¨å…¬ä¼—å·å›å¤ã€Œfedã€è·å–</p> <p><img src="https://xiaomuzhu-image.oss-cn-beijing.aliyuncs.com/d846f65d5025c4b6c4619662a0669503.png" alt="2019-08-12-03-18-41"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/xiaomuzhu/front-end-interview/edit/master/packages/docs/docs/guide/event.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/front-end-interview/guide/deepclone.html" class="prev">
          å®ç°æ·±å…‹éš†
        </a></span> <span class="next"><a href="/front-end-interview/guide/mechanism.html">
          JavaScriptçš„è¿è¡Œæœºåˆ¶
        </a>
        â†’
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/front-end-interview/assets/js/app.cf4632d5.js" defer></script><script src="/front-end-interview/assets/js/3.27562796.js" defer></script><script src="/front-end-interview/assets/js/34.c2dc7fd1.js" defer></script><script src="/front-end-interview/assets/js/6.4cd0594d.js" defer></script>
  </body>
</html>
